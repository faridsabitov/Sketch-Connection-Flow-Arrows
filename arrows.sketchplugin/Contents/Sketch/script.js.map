{"version":3,"sources":["webpack://exports/webpack/bootstrap","webpack://exports/./src/script.js","webpack://exports/external \"sketch\"","webpack://exports/external \"sketch/dom\"","webpack://exports/external \"sketch/settings\"","webpack://exports/external \"sketch/ui\""],"names":["UI","require","SharedStyle","pluginKey","document","sketch","fromNative","context","docData","documentData","pluginData","command","valueForKey_onLayer_forPluginIdentifier","currentParentGroup","currentPage","currentArtboard","newConnectionsData","getConnectionsData","Settings","arrowDirectionSetting","settingForKey","createDefaultArrow","start","createAutoArrow","createRightArrow","createDownArrow","createLeftArrow","createUpArrow","updateSelectedArrows","selection","count","currentConnectionsData","g","objectID","connectionIndex","findConnectionData","updateArrow","firstObject","secondObject","style","type","direction","line","message","setValue_forKey_onLayer_forPluginIdentifier","updateArtboardArrows","connections","firstObjectArtboard","secondObjectArtboard","length","updateArrowsCounter","i","getLayerWithID","sketchObject","parentArtboard","class","push","updateAllArrows","deleteAllArrows","deleteLine","deleteArtboardArrows","deleteConnectionFromData","deleteSelectedArrows","settings","alert","COSAlertWindow","new","viewWidth","viewHeight","alertSetup","view","NSView","alloc","initWithFrame","NSMakeRect","addAccessoryView","arrowStyleLabel","alertLabel","addSubview","arrowStylingField","NSPopUpButton","setActiveStyleSetting","arrowStyleInfoLabel","arrowTypeLabel","arrowTypeField","setActiveTypeSetting","arrowTypeInfoLabel","arrowSpacingLabel","arrowSpacingPxLabel","arrowSpacingField","NSTextField","formatter","NSNumberFormatter","init","autorelease","setStringValue","String","setFormatter","arrowSpacingStepper","NSStepper","setMaxValue","setMinValue","setValueWraps","setAutorepeat","setCOSJSTargetFunction","sender","value","integerValue","arrowSpacingInfoLabel","otherSettingsLabel","checkbox","alertCheckbox","autoAlignInfoLabel","pluginInfoLabel","modalResponse","runModal","NSAlertFirstButtonReturn","views","subviews","title","setSettingForKey","intValue","state","onLayersMoved","action","actionContext","panel","ControlBar","NSPanel","setStyleMask","NSTitledWindowMask","NSFullSizeContentViewWindowMask","setTitleVisibility","NSWindowTitleHidden","setTitlebarAppearsTransparent","setFrame_display","setMovableByWindowBackground","setHasShadow","setLevel","NSFloatingWindowLevel","center","makeKeyAndOrderFront","nil","firstObjectID","secondObjectID","lineID","createArrow","localDirection","localStyle","localType","getDirection","getLayerStyles","updateSpacing","autoAlignLayer","currentGroup","checkForArrowGroup","drawLine","addToArrowsGroup","connection","layers","name","refactorLines","firstObjectMidX","frame","x","width","firstObjectMidY","y","height","secondObjectMidX","secondObjectMidY","diffX","diffY","absDiffX","Math","abs","absDiffY","firstLayerPosX","firstLayerPosY","secondLayerPosX","secondLayerPosY","middlePosX","middlePosY","firstObjectAbsPos","changeBasis","from","parent","to","secondObjectAbsPos","path","NSBezierPath","bezierPath","moveToPoint","NSMakePoint","lineToPoint","MSShapeGroup","layerWithPath","MSPath","pathWithBezierPath","points","cornerRadius","setName","curveMode","hasCurveFrom","hasCurveTo","curveFrom","curveTo","border","addStylePartOfType","color","MSColor","colorWithRGBADictionary","r","b","a","thickness","endMarkerType","sharedStyle","ownStyle","addLayers","fixGeometryWithOptions","Group","group","locked","moveToBack","dataArray","pluginDataConnections","data","arrayNumber","setActiveDirectionSetting","arrowDirectionField","currentDirection","addItemWithTitle","lastItem","setState","docSettings","styles","docTypeSettings","newConnections","lineObject","selectedGroup","remove","sourceObjectID","childObjectID","sourceObject","childObject","currentSpacing","sourceMidY","childMidY","sourceMidX","childMidX","diff","defineSourceObject","id","getSourceObjectFromSelection","confirmationAlert","setMessageText","addButtonWithTitle","infoLabel","setSelectable","setDrawsBackground","setBezeled","textColor","NSColor","disabledControlTextColor","NSButton","setButtonType","NSSwitchButton","setBezelStyle","setTitle","currentState","allStyles","allLayerStyles","keyword","includes"],"mappings":"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","file":"script.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/script.js\");\n","import sketch from 'sketch'\n// const { toArray } = require('util')\n\n//\n//  Variables\n//\n\nlet UI = require('sketch/ui') \nvar SharedStyle = require('sketch/dom').SharedStyle\n\nconst pluginKey = \"flowArrows\"\nconst document = sketch.fromNative(context.document)\nlet docData = context.document.documentData()\nlet pluginData = context.command.valueForKey_onLayer_forPluginIdentifier(\"arrowConnections\", docData, pluginKey) // TODO: Need to refactor\nlet currentParentGroup = docData.currentPage().currentArtboard() || docData.currentPage() // TODO: Might be a problem for multiple artboards\nlet newConnectionsData = getConnectionsData()\n\n// Settings\nvar Settings = require('sketch/settings')\nlet arrowDirectionSetting\n\nif(Settings.settingForKey(\"arrowDirection\")) {\n  arrowDirectionSetting = Settings.settingForKey('arrowDirection')\n} else {\n  arrowDirectionSetting = \"Auto\"\n}\n  \n//\n//  Create Connection Function\n//\n\nexport default function(context) {}\nexport function createDefaultArrow(context){start(context, null)}\nexport function createAutoArrow(context){start(context, \"Auto\")}\nexport function createRightArrow(context){start(context, \"Right\")}\nexport function createDownArrow(context){start(context, \"Down\")}\nexport function createLeftArrow(context){start(context, \"Left\")}\nexport function createUpArrow(context){start(context, \"Up\")}\n\n//\n// Plugin Commands\n//\n\nexport function updateSelectedArrows(context) {\n\n  let selection = context.selection\n\n  if(selection.count() > 1){\n    // Need to find source object by ID first\n    // let sourceObjectID = getSourceObjectFromSelection(selection)\n    let currentConnectionsData = newConnectionsData\n\n    for(let g = 0; g < selection.count(); g++) {\n      if(selection[g].objectID() != selection[0].objectID()){\n        // Then need to create or update connection arrow with each selection\n        let connectionIndex = findConnectionData(selection[0].objectID(), selection[g].objectID(), currentConnectionsData)\n\n        if(connectionIndex != null){\n          updateArrow(currentConnectionsData[connectionIndex].firstObject, currentConnectionsData[connectionIndex].secondObject, currentConnectionsData[connectionIndex].style, currentConnectionsData[connectionIndex].type, currentConnectionsData[connectionIndex].direction, currentConnectionsData[connectionIndex].line, connectionIndex)\n          sketch.UI.message(\"Current connection is updated \")\n        } else {\n          sketch.UI.message(\"There is no connection between selected layers on the plugin data\")\n        }\n      }\n    }\n    context.command.setValue_forKey_onLayer_forPluginIdentifier(newConnectionsData, \"arrowConnections\", docData, pluginKey)\n  } else {\n    // When user didn't select anything\n    sketch.UI.message(\"Please select more than two layers\")\n  }\n}\n\nexport function updateArtboardArrows(context) {\n  // TODO: Need to show amount of updated arrows and deleted ones\n  let selection = context.selection\n  let connections = getConnectionsData()\n  let firstObjectArtboard\n  let secondObjectArtboard\n  \n  if(connections.length > 0){\n    // We have connections in database\n    const updateArrowsCounter = connections.length\n    for (let i = 0; i < updateArrowsCounter; i ++) {\n      // Need to check if the element is selected globally or from the artboard\n      firstObjectArtboard = document.getLayerWithID(connections[i].firstObject)\n      firstObjectArtboard = firstObjectArtboard.sketchObject.parentArtboard().objectID()\n\n      secondObjectArtboard = document.getLayerWithID(connections[i].secondObject)\n      secondObjectArtboard = secondObjectArtboard.sketchObject.parentArtboard().objectID()\n\n      if(selection.count() == 1 && selection[0].class() == \"MSArtboardGroup\"){\n        // Need to go through each connection and update arrow position for specific artboard\n        \n        if (firstObjectArtboard == selection[0].objectID()){\n          if (secondObjectArtboard == selection[0].objectID()){\n            updateArrow(connections[i].firstObject, connections[i].secondObject, connections[i].style, connections[i].type, connections[i].direction, connections[i].line, i)\n          } else {newConnectionsData.push(connections[i])}\n        } else {\n          // If not just saving it\n          newConnectionsData.push(connections[i])\n        }\n      }\n    }\n    context.command.setValue_forKey_onLayer_forPluginIdentifier(newConnectionsData, \"arrowConnections\", docData, pluginKey)\n    sketch.UI.message(\"All arrows are updated \")\n  } else {\n    // We don't have any connections to update\n    sketch.UI.message(\"There is nothing to update\")\n  }\n}\n\nexport function updateAllArrows(context) { // TODO\n  // TODO: Need to show amount of updated arrows and deleted ones\n  let currentConnectionsData = newConnectionsData\n  if(currentConnectionsData.length > 0){\n    // We have connections in database\n    const updateArrowsCounter = currentConnectionsData.length\n    for (let i = 0; i < updateArrowsCounter; i ++) {\n      // Need to go through each connection and update arrow position without artboards\n      // Need to check if current object don't have the parrent\n      updateArrow(currentConnectionsData[i].firstObject, currentConnectionsData[i].secondObject, currentConnectionsData[i].style, currentConnectionsData[i].type, currentConnectionsData[i].direction, currentConnectionsData[i].line, i)\n    }\n    context.command.setValue_forKey_onLayer_forPluginIdentifier(newConnectionsData, \"arrowConnections\", docData, pluginKey)\n    sketch.UI.message(\"All arrows are updated \")\n  } else {\n    // We don't have any connections to update\n    sketch.UI.message(\"There is nothing to update\")\n  }\n}\n\nexport function deleteAllArrows(context) {\n\n  if(newConnectionsData.length > 0){\n    // We have connections in database\n    for (let i = 0; i < newConnectionsData.length; i ++) {\n      // Need to go through each connection and update arrow position\n      deleteLine(newConnectionsData[i].line)\n    }\n    context.command.setValue_forKey_onLayer_forPluginIdentifier(null, \"arrowConnections\", docData, pluginKey)\n    sketch.UI.message(\"All arrows are deleted\")\n  } else {\n    // We don't have any connections to update\n    sketch.UI.message(\"There is nothing to delete\")\n  }\n}\n\nexport function deleteArtboardArrows(context) {\n  let selection = context.selection\n  let firstObject, secondObject\n\n  // Need to delete all the arrows only from selected artboard\n  if(selection.count() == 1 && selection[0].class() == \"MSArtboardGroup\"){\n    let connections = getConnectionsData()\n    \n    if(connections.length > 0){\n      // We have connections in database\n      const updateArrowsCounter = connections.length\n      for (let i = 0; i < updateArrowsCounter; i ++) {\n        // Need to go through each connection and check if it placed on selected artboard\n        firstObject = document.getLayerWithID(connections[i].firstObject)\n        secondObject = document.getLayerWithID(connections[i].secondObject)\n        if (firstObject.sketchObject.parentArtboard().objectID() == selection[0].objectID()){\n          if (secondObject.sketchObject.parentArtboard().objectID() == selection[0].objectID()){\n            deleteLine(connections[i].line)\n            newConnectionsData = deleteConnectionFromData(i)\n          }\n        }\n      }\n      context.command.setValue_forKey_onLayer_forPluginIdentifier(newConnectionsData, \"arrowConnections\", docData, pluginKey)\n      sketch.UI.message(\"All arrows from selected artboard are deleted\")\n    } else {\n      // We don't have any connections to update\n      sketch.UI.message(\"There is nothing to delete\")\n    }\n  } else {\n    sketch.UI.message(\"Please select one artboard\")\n  }\n}\n\nexport function deleteSelectedArrows(context) {\n  let selection = context.selection\n  let firstObject, secondObject\n\n  // Need to delete all the arrows only from selected artboard\n  if(selection.count() == 2){\n\n    for(let g = 0; g < selection.count(); g++) {\n\n      if(selection[g].objectID() != selection[0].objectID()){ // It will never check 3rd connection\n        let connections = getConnectionsData()\n        \n        let connectionIndex = findConnectionData(selection[0].objectID(), selection[g].objectID(), connections)\n        \n        if(connectionIndex != null){\n          // We have connections in database\n          deleteLine(connections[connectionIndex].line)\n          newConnectionsData = deleteConnectionFromData(connectionIndex)\n          const updateArrowsCounter = connections.length\n          for (let i = 0; i < updateArrowsCounter; i ++) {\n            // Need to go through each connection and check if it placed on selected artboard\n            firstObject = document.getLayerWithID(connections[i].firstObject)\n            secondObject = document.getLayerWithID(connections[i].secondObject)\n            if(firstObject.sketchObject.parentArtboard().objectID() == selection[0].objectID()){\n              if(secondObject.sketchObject.parentArtboard().objectID() == selection[0].objectID()){\n                deleteLine(connections[i].line)\n                newConnectionsData = deleteConnectionFromData(i)\n              }\n            }\n          }\n          context.command.setValue_forKey_onLayer_forPluginIdentifier(newConnectionsData, \"arrowConnections\", docData, pluginKey)\n          sketch.UI.message(\"All arrows from selected layers are deleted \")\n        }\n      }\n    }\n  } else {\n    sketch.UI.message(\"Select two layers, please \")\n  }\n}\n\nexport function settings(context) {\n  let alert = COSAlertWindow.new()\n  const viewWidth = 300\n  const viewHeight = 450\n  \n  // Alert window settings\n  alert = alertSetup(alert, viewWidth, viewHeight)\n  let view = NSView.alloc().initWithFrame(NSMakeRect(0, 0, viewWidth, viewHeight))\n  alert.addAccessoryView(view)\n\n  // Label: Arrow Style\n  let arrowStyleLabel = alertLabel(\"Arrow Style\", true, -1, viewHeight-40, 280, 40)\n  view.addSubview(arrowStyleLabel)\n\n  // Select: Arrow Style\n  let arrowStylingField = NSPopUpButton.alloc().initWithFrame(NSMakeRect(-2, viewHeight - 40, 300, 20));\n  setActiveStyleSetting(arrowStylingField)\n  view.addSubview(arrowStylingField)\n\n  // Label: Arrow Style Info\n  let arrowStyleInfoLabel = alertLabel(\"Add layer style to your document that will contain $arrow name and you will be able to specify it here \", false, -1, viewHeight-80, 300, 40)\n  view.addSubview(arrowStyleInfoLabel)\n\n\n  // Label: Arrow Type\n  let arrowTypeLabel = alertLabel(\"Arrow Type\", true, -1, viewHeight-130, 280, 40)\n  view.addSubview(arrowTypeLabel)\n\n  // Select: Arrow Type\n  let arrowTypeField = NSPopUpButton.alloc().initWithFrame(NSMakeRect(-2, viewHeight - 130, 300, 20));\n  setActiveTypeSetting(arrowTypeField)\n  view.addSubview(arrowTypeField)\n\n  // Label: Arrow Type Info\n  let arrowTypeInfoLabel = alertLabel(\"Select one of the arrow types. Angled is used by default\", false, -1, viewHeight-170, 300, 40)\n  view.addSubview(arrowTypeInfoLabel)\n\n\n  // Label: Arrow Spacing\n  let arrowSpacingLabel = alertLabel(\"Arrow Spacing\", true, -1, viewHeight - 200, 330, 20)\n  view.addSubview(arrowSpacingLabel)\n\n  // Label: Arrow Spacing PX\n  let arrowSpacingPxLabel = alertLabel(\"px\", true, 90, viewHeight - 220, 330, 20)\n  view.addSubview(arrowSpacingPxLabel)\n\n  // Input: Arrow Spacing\n  let arrowSpacingField = NSTextField.alloc().initWithFrame(NSMakeRect(-2, viewHeight - 220, 80, 20))\n  var formatter = NSNumberFormatter.alloc().init().autorelease()\n  arrowSpacingField.setStringValue(String(Settings.settingForKey(\"arrowSpacing\")))\n  arrowSpacingField.setFormatter(formatter)\n  view.addSubview(arrowSpacingField)\n\n  // Stepper: Arrow Spacing\n  let arrowSpacingStepper = NSStepper.alloc().initWithFrame(NSMakeRect(70, viewHeight - 220, 20, 20));\n  arrowSpacingStepper.setMaxValue(1000)\n  arrowSpacingStepper.setMinValue(0)\n  arrowSpacingStepper.setValueWraps(false)\n  arrowSpacingStepper.setAutorepeat(true)\n  arrowSpacingStepper.setCOSJSTargetFunction(function(sender){\n    var value = 0 + sender.integerValue()\n    arrowSpacingField.setStringValue(String(value))\n  })\n  \n  view.addSubview(arrowSpacingStepper)\n  // view.addSubview(formatter)\n  \n  // Label: Auto Spacing Info\n  let arrowSpacingInfoLabel = alertLabel(\"The second layer will be moved closer based on the value provided here. Keep it 0 if you don't want to have auto spacing feature \", false, -1, viewHeight-285, 300, 60)\n  view.addSubview(arrowSpacingInfoLabel)\n\n  // Label: Other Settings\n  let otherSettingsLabel = alertLabel(\"Other Settings\", true, -1, viewHeight-330, 280, 40)\n  view.addSubview(otherSettingsLabel)\n\n  // Checkbox: Auto-Align\n  let checkbox = alertCheckbox(\"Second layer auto-align\", false, -1, viewHeight-340, 260, 40)\n  view.addSubview(checkbox)\n\n  // Label: Auto-Align Info\n  let autoAlignInfoLabel = alertLabel(\"Align the second layer for 5px misalignment with the first one\", false, -1, viewHeight-370, 280, 40)\n  view.addSubview(autoAlignInfoLabel)\n\n  // Label: Plugin Info\n  let pluginInfoLabel = alertLabel(\"Made by @faridSabitov with the support of EPAM.com \", true, -1, viewHeight-420, 280, 40)\n  view.addSubview(pluginInfoLabel)\n\n\n  // Need to check if style is still available\n\n  // Show modal and get the results\n  let modalResponse = alert.runModal()\n\n  if(modalResponse == NSAlertFirstButtonReturn){\n    // When user clicks on \"Update Settings\"\n    // Need to save all this results into the Plugin Settings\n    context.command.setValue_forKey_onLayer_forPluginIdentifier(alert.views()[0].subviews()[1].title(), \"arrowStyle\", docData, pluginKey)\n    Settings.setSettingForKey(\"arrowType\", alert.views()[0].subviews()[4].title())\n    Settings.setSettingForKey(\"arrowSpacing\", alert.views()[0].subviews()[8].intValue())\n    Settings.setSettingForKey(\"autoAlign\", alert.views()[0].subviews()[12].state())\n    UI.message(\"Settings are updated \")\n  }\n}\n\nexport function onLayersMoved(context) {\n  sketch.UI.message(\"Please select more than two layers\")\n  const action = context.actionContext  \n}\n\nexport function panel(context) {\n  let ControlBar\n  ControlBar = NSPanel.alloc().init();\n  ControlBar.setStyleMask(NSTitledWindowMask + NSFullSizeContentViewWindowMask);\n  // ControlBar.setBackgroundColor(NSColor.colorWithRed_green_blue_alpha(0.99, 0.99, 0.99, 1));\n  ControlBar.setTitleVisibility(NSWindowTitleHidden);\n  ControlBar.setTitlebarAppearsTransparent(true);\n  ControlBar.setFrame_display(NSMakeRect(0, 0, 720, 50), false);\n  ControlBar.setMovableByWindowBackground(true);\n  ControlBar.setHasShadow(true);\n  ControlBar.setLevel(NSFloatingWindowLevel);\n\n  // contentView.addSubview(closeButton)\n  ControlBar.center();\n  ControlBar.makeKeyAndOrderFront(nil);\n\n//   getImage = function(size, name){\n//     var isRetinaDisplay = (NSScreen.mainScreen().backingScaleFactor() > 1)? true: false;\n//         suffix = (isRetinaDisplay)? \"@2x\": \"\",\n//         imageURL = NSURL.fileURLWithPath(self.pluginResources + \"/icons/\" + name + suffix + \".png\"),\n//         image = NSImage.alloc().initWithContentsOfURL(imageURL);\n//     return image\n// },\n// addButton = function(rect, name, callAction){\n//     var button = NSButton.alloc().initWithFrame(rect),\n//         image = getImage(rect.size, name);\n\n//     button.setImage(image);\n//     button.setBordered(false);\n//     button.sizeToFit();\n//     button.setButtonType(NSMomentaryChangeButton);\n//     button.setCOSJSTargetFunction(callAction);\n//     button.setAction(\"callAction:\");\n//     return button;\n// },\n// addImage = function(rect, name){\n//     var view = NSImageView.alloc().initWithFrame(rect),\n//         image = getImage(rect.size, name);\n//     view.setImage(image);\n//     return view;\n// },\n\n// closeButton = addButton( NSMakeRect(20, 10, 30, 30), \"close-control\",\n//     function(sender){\n//         coscript.setShouldKeepAround(false);\n//         threadDictionary.removeObjectForKey(identifier);\n//         ControlBar.close();\n// }),\n\n\n\n}\n\n//\n// Functions\n//\n\nfunction updateArrow(firstObjectID, secondObjectID, style, type, direction, lineID, connectionIndex) {\n  // There might be a situation, when user deleted current group or current group stays on another artboard => In that case need to create another group\n  // Need to check if we have the layers with such IDs\n  let firstObject = document.getLayerWithID(firstObjectID)\n  let secondObject = document.getLayerWithID(secondObjectID)\n\n  // Need to delete data first, because we will have a new line\n  deleteLine(lineID)\n  newConnectionsData = deleteConnectionFromData(connectionIndex)\n\n  if(firstObject && secondObject){\n    // If we have all the objects, we can recreate the line\n    createArrow(firstObjectID, secondObjectID, style, type, direction)\n  } \n}\n\nfunction createArrow(firstObjectID, secondObjectID, style, type, direction) {\n  // Process of creating new connection  \n  let localDirection, localStyle, localType\n  if(direction == \"Auto\"){\n    // If direction is auto, we need to specify direction ourselves\n    localDirection = getDirection(firstObjectID, secondObjectID)\n  } else {\n    localDirection = direction\n  }\n\n  if(type == null){\n    localType = Settings.settingForKey(\"arrowType\")  \n  } else {\n    localType = type\n  }\n  \n  // log(context.command.valueForKey_onLayer_forPluginIdentifier(\"arrowStyle\", docData, pluginKey))\n  localStyle = getLayerStyles(context.command.valueForKey_onLayer_forPluginIdentifier(\"arrowStyle\", docData, pluginKey))\n  \n  if(style != null){\n    // if we updating connection with previously created objects\n    if(getLayerStyles(style) != null && style != \"Default Style\"){\n      localStyle = style\n    } else {\n      localStyle = \"Default Style\"\n    }\n  } else {\n    // We don't have any data from the plugin data\n    if(context.command.valueForKey_onLayer_forPluginIdentifier(\"arrowStyle\", docData, pluginKey)){\n      localStyle = context.command.valueForKey_onLayer_forPluginIdentifier(\"arrowStyle\", docData, pluginKey)\n    } else {\n      localStyle = \"Default Style\"\n    }\n    \n  }\n  \n  \n  updateSpacing(firstObjectID, secondObjectID, localDirection)\n  autoAlignLayer(firstObjectID, secondObjectID, localDirection)\n  let currentGroup = checkForArrowGroup()\n  let line = drawLine(firstObjectID, secondObjectID, localStyle, localType, localDirection, currentGroup)\n  addToArrowsGroup(line, currentGroup)\n\n\n  // if(localStyle != \"Default Style\"){\n  //   localStyle = localStyle[0].name()\n  // }\n\n  // Storage for current connection\n  let connection = {\n    firstObject : firstObjectID,\n    secondObject : secondObjectID,\n    style : localStyle,\n    type : localType,\n    direction: localDirection,\n    line : line.objectID()\n  }\n  // Need to save this data to the global array\n  newConnectionsData.push(connection)\n}\n\nfunction checkForArrowGroup() {\n  let currentGroup = null\n  // Checking all the groups that we have\n  for(let i = 0; i < currentParentGroup.layers().count(); i++){\n    if(currentParentGroup.layers()[i].name() == \"Arrows\") {\n      // If we already have \"Arrow\" group we need to save it's folder\n      currentGroup = currentParentGroup.layers()[i]\n      refactorLines(currentGroup)\n    } \n  }\n  return currentGroup\n}\n\nfunction getDirection(firstObjectID, secondObjectID){\n  // Get direction from the source object\n  const firstObject = document.getLayerWithID(firstObjectID)\n  const secondObject = document.getLayerWithID(secondObjectID)\n  const firstObjectMidX = firstObject.frame.x+firstObject.frame.width/2\n  const firstObjectMidY = firstObject.frame.y+firstObject.frame.height/2\n  const secondObjectMidX = secondObject.frame.x+secondObject.frame.width/2\n  const secondObjectMidY = secondObject.frame.y+secondObject.frame.height/2\n\n  const diffX = firstObjectMidX - secondObjectMidX\n  const diffY = firstObjectMidY - secondObjectMidY\n  const absDiffX = Math.abs(diffX) \n  const absDiffY = Math.abs(diffY)\n  let direction\n\n  if(secondObjectMidX > firstObjectMidX){\n    // Right Half\n    if(secondObjectMidY > firstObjectMidY){\n      // Bottom quarter\n      if(diffX > diffY) {\n        direction = \"Down\"\n      } else {\n        direction = \"Right\"\n      }\n    } else {\n      // Top quarter\n      if(absDiffX > absDiffY) {\n        direction = \"Right\"\n      } else {\n        direction = \"Up\"\n      }\n    }\n  } else {\n    // Left Half\n    if(secondObjectMidY > firstObjectMidY){\n      // Bottom quarter\n      if(absDiffX > absDiffY) {\n        direction = \"Left\"\n      } else {\n        direction = \"Down\"\n      }\n    } else {\n      // Top quarter\n      if(diffX > diffY) {\n        direction = \"Left\"\n      } else {\n        direction = \"Up\"\n      }\n    }\n  }\n  return direction\n}\n\nfunction drawLine(firstObjectID, secondObjectID, style, type, direction, currentGroup){\n  let firstLayerPosX, firstLayerPosY, secondLayerPosX, secondLayerPosY, middlePosX, middlePosY, diffX, diffY, line\n  let firstObject = document.getLayerWithID(firstObjectID)\n  let secondObject = document.getLayerWithID(secondObjectID)\n\n  let firstObjectAbsPos = firstObject.frame.changeBasis({from: firstObject.parent, to: currentParentGroup})\n  let secondObjectAbsPos = secondObject.frame.changeBasis({from: secondObject.parent, to: currentParentGroup})\n\n  if(currentGroup){\n    //if we already have a group, need to specify the difference\n    diffX = currentGroup.frame().x()\n    diffY = currentGroup.frame().y()\n  } else {\n    diffX = 0\n    diffY = 0\n  }\n\n  // Drawing a line\n  let path = NSBezierPath.bezierPath()\n\n  if(type == \"Angled\" || type == null){\n    // Based on direction, we need to specify connection points\n    \n    if(direction == \"Up\"){\n      // First Layer Position Start Point Position\n      firstLayerPosX = firstObjectAbsPos.x+firstObjectAbsPos.width/2-diffX\n      firstLayerPosY = firstObjectAbsPos.y-diffY\n\n      // Second Layer Position End Point Position\n      secondLayerPosX = secondObjectAbsPos.x+secondObjectAbsPos.width/2-diffX\n      secondLayerPosY = secondObjectAbsPos.y+secondObjectAbsPos.height-diffY\n\n      // Middle Points\n      middlePosX = (firstLayerPosX + secondLayerPosX)/2\n      middlePosY = (firstLayerPosY + secondLayerPosY)/2\n\n      // Connecting points\n      path.moveToPoint(NSMakePoint(firstLayerPosX,firstLayerPosY))\n      path.lineToPoint(NSMakePoint(firstLayerPosX,middlePosY))\n      path.lineToPoint(NSMakePoint(secondLayerPosX,middlePosY))\n      path.lineToPoint(NSMakePoint(secondLayerPosX,secondLayerPosY))\n    }\n\n    if(direction == \"Right\"){\n      // First Layer Position Start Point Position\n      firstLayerPosX = firstObjectAbsPos.x+firstObjectAbsPos.width-diffX\n      firstLayerPosY = firstObjectAbsPos.y+firstObjectAbsPos.height/2-diffY\n\n      // Second Layer Position End Point Position\n      secondLayerPosX = secondObjectAbsPos.x-diffX\n      secondLayerPosY = secondObjectAbsPos.y+secondObjectAbsPos.height/2-diffY\n      \n      // Middle Points\n      middlePosX = (firstLayerPosX + secondLayerPosX)/2\n      middlePosY = (firstLayerPosY + secondLayerPosY)/2\n\n      // Connecting points\n      path.moveToPoint(NSMakePoint(firstLayerPosX,firstLayerPosY))\n      path.lineToPoint(NSMakePoint(middlePosX,firstLayerPosY))\n      path.lineToPoint(NSMakePoint(middlePosX,secondLayerPosY))\n      path.lineToPoint(NSMakePoint(secondLayerPosX,secondLayerPosY))\n    }\n\n    if(direction == \"Down\"){\n      // First Layer Position Start Point Position\n      firstLayerPosX = firstObjectAbsPos.x+firstObjectAbsPos.width/2-diffX\n      firstLayerPosY = firstObjectAbsPos.y+firstObjectAbsPos.height-diffY\n\n      // Second Layer Position End Point Position\n      secondLayerPosX = secondObjectAbsPos.x+secondObjectAbsPos.width/2-diffX\n      secondLayerPosY = secondObjectAbsPos.y-diffY\n\n      // Middle Points\n      middlePosX = (firstLayerPosX + secondLayerPosX)/2\n      middlePosY = (firstLayerPosY + secondLayerPosY)/2\n      \n      // Connecting points\n      path.moveToPoint(NSMakePoint(firstLayerPosX,firstLayerPosY))\n      path.lineToPoint(NSMakePoint(firstLayerPosX,middlePosY))\n      path.lineToPoint(NSMakePoint(secondLayerPosX,middlePosY))\n      path.lineToPoint(NSMakePoint(secondLayerPosX,secondLayerPosY))\n    }\n\n    if(direction == \"Left\"){\n      // First Layer Position Start Point Position\n      firstLayerPosX = firstObjectAbsPos.x-diffX\n      firstLayerPosY = firstObjectAbsPos.y+firstObjectAbsPos.height/2-diffY\n\n      // Second Layer Position End Point Position\n      secondLayerPosX = secondObjectAbsPos.x+secondObjectAbsPos.width-diffX\n      secondLayerPosY = secondObjectAbsPos.y+secondObjectAbsPos.height/2-diffY\n\n      // Middle Points\n      middlePosX = (firstLayerPosX + secondLayerPosX)/2\n      middlePosY = (firstLayerPosY + secondLayerPosY)/2\n\n      // Connecting points\n      path.moveToPoint(NSMakePoint(firstLayerPosX,firstLayerPosY))\n      path.lineToPoint(NSMakePoint(middlePosX,firstLayerPosY))\n      path.lineToPoint(NSMakePoint(middlePosX,secondLayerPosY))\n      path.lineToPoint(NSMakePoint(secondLayerPosX,secondLayerPosY))\n    }\n\n    //TODO: Provide a separate file with all the stylings\n\n    // Painting the line\n    line = MSShapeGroup.layerWithPath(MSPath.pathWithBezierPath(path))\n\n\n    // Making middle points rounded\n    let points = line.layers().firstObject().points()\n    points[1].cornerRadius = 20\n    points[2].cornerRadius = 20\n\n    // Providing Settings for the arrow\n    line.setName(\"Arrow\")\n  }\n\n  if(type == \"Straight\"){\n    // Based on direction, we need to specify connection points\n    if(direction == \"Up\"){\n      // First Layer Position Start Point Position\n      firstLayerPosX = firstObjectAbsPos.x+firstObjectAbsPos.width/2-diffX\n      firstLayerPosY = firstObjectAbsPos.y-diffY\n\n      // Second Layer Position End Point Position\n      secondLayerPosX = secondObjectAbsPos.x+secondObjectAbsPos.width/2-diffX\n      secondLayerPosY = secondObjectAbsPos.y+secondObjectAbsPos.height-diffY\n\n      // Middle Points\n      middlePosX = (firstLayerPosX + secondLayerPosX)/2\n      middlePosY = (firstLayerPosY + secondLayerPosY)/2\n\n      // Connecting points\n      path.moveToPoint(NSMakePoint(firstLayerPosX,firstLayerPosY))\n      path.lineToPoint(NSMakePoint(secondLayerPosX,secondLayerPosY))\n    }\n\n    if(direction == \"Right\"){\n      // First Layer Position Start Point Position\n      firstLayerPosX = firstObjectAbsPos.x+firstObjectAbsPos.width-diffX\n      firstLayerPosY = firstObjectAbsPos.y+firstObjectAbsPos.height/2-diffY\n\n      // Second Layer Position End Point Position\n      secondLayerPosX = secondObjectAbsPos.x-diffX\n      secondLayerPosY = secondObjectAbsPos.y+secondObjectAbsPos.height/2-diffY\n      \n      // Middle Points\n      middlePosX = (firstLayerPosX + secondLayerPosX)/2\n      middlePosY = (firstLayerPosY + secondLayerPosY)/2\n\n      // Connecting points\n      path.moveToPoint(NSMakePoint(firstLayerPosX,firstLayerPosY))\n      path.lineToPoint(NSMakePoint(secondLayerPosX,secondLayerPosY))\n    }\n\n    if(direction == \"Down\"){\n      // First Layer Position Start Point Position\n      firstLayerPosX = firstObjectAbsPos.x+firstObjectAbsPos.width/2-diffX\n      firstLayerPosY = firstObjectAbsPos.y+firstObjectAbsPos.height-diffY\n\n      // Second Layer Position End Point Position\n      secondLayerPosX = secondObjectAbsPos.x+secondObjectAbsPos.width/2-diffX\n      secondLayerPosY = secondObjectAbsPos.y-diffY\n\n      // Middle Points\n      middlePosX = (firstLayerPosX + secondLayerPosX)/2\n      middlePosY = (firstLayerPosY + secondLayerPosY)/2\n      \n      // Connecting points\n      path.moveToPoint(NSMakePoint(firstLayerPosX,firstLayerPosY))\n      path.lineToPoint(NSMakePoint(secondLayerPosX,secondLayerPosY))\n    }\n\n    if(direction == \"Left\"){\n      // First Layer Position Start Point Position\n      firstLayerPosX = firstObjectAbsPos.x-diffX\n      firstLayerPosY = firstObjectAbsPos.y+firstObjectAbsPos.height/2-diffY\n\n      // Second Layer Position End Point Position\n      secondLayerPosX = secondObjectAbsPos.x+secondObjectAbsPos.width-diffX\n      secondLayerPosY = secondObjectAbsPos.y+secondObjectAbsPos.height/2-diffY\n\n      // Middle Points\n      middlePosX = (firstLayerPosX + secondLayerPosX)/2\n      middlePosY = (firstLayerPosY + secondLayerPosY)/2\n\n      // Connecting points\n      path.moveToPoint(NSMakePoint(firstLayerPosX,firstLayerPosY))\n      path.lineToPoint(NSMakePoint(secondLayerPosX,secondLayerPosY))\n    }\n\n    // Painting the line\n    line = MSShapeGroup.layerWithPath(MSPath.pathWithBezierPath(path))\n      \n    // Providing Settings for the arrow\n    line.setName(\"Arrow\")\n  }\n\n  if(type == \"Curved\"){\n    // Based on direction, we need to specify connection points\n    if(direction == \"Up\"){\n      // First Layer Position Start Point Position\n      firstLayerPosX = firstObjectAbsPos.x+firstObjectAbsPos.width/2-diffX\n      firstLayerPosY = firstObjectAbsPos.y-diffY\n\n      // Second Layer Position End Point Position\n      secondLayerPosX = secondObjectAbsPos.x+secondObjectAbsPos.width/2-diffX\n      secondLayerPosY = secondObjectAbsPos.y+secondObjectAbsPos.height-diffY\n\n      // Middle Points\n      middlePosX = (firstLayerPosX + secondLayerPosX)/2\n      middlePosY = (firstLayerPosY + secondLayerPosY)/2\n\n      // Connecting points\n      path.moveToPoint(NSMakePoint(firstLayerPosX,firstLayerPosY))\n      path.lineToPoint(NSMakePoint(secondLayerPosX,secondLayerPosY))\n\n      // Painting the line\n      line = MSShapeGroup.layerWithPath(MSPath.pathWithBezierPath(path))\n      let points = line.layers().firstObject().points()\n\n      points[0].curveMode = points[1].curveMode = 4\n      points[0].hasCurveFrom = points[1].hasCurveTo = true\n\n      if(firstLayerPosX<secondLayerPosX){\n        points[0].curveFrom = {x: 0, y: 0.5}\n        points[0].curveTo = {x: -0.5,y:1}\n\n        points[1].curveFrom = {x: 1,y: 1}\n        points[1].curveTo = {x: 1,y: 0.5}\n      } else {\n        points[0].curveFrom = {x: 1, y: 0.5}\n        points[0].curveTo = {x: -0.5,y:1}\n\n        points[1].curveFrom = {x: 1,y: 1}\n        points[1].curveTo = {x: 0,y: 0.5}\n      }\n    }\n\n    if(direction == \"Right\"){\n      // First Layer Position Start Point Position\n      firstLayerPosX = firstObjectAbsPos.x+firstObjectAbsPos.width-diffX\n      firstLayerPosY = firstObjectAbsPos.y+firstObjectAbsPos.height/2-diffY\n\n      // Second Layer Position End Point Position\n      secondLayerPosX = secondObjectAbsPos.x-diffX\n      secondLayerPosY = secondObjectAbsPos.y+secondObjectAbsPos.height/2-diffY\n      \n      // Middle Points\n      middlePosX = (firstLayerPosX + secondLayerPosX)/2\n      middlePosY = (firstLayerPosY + secondLayerPosY)/2\n\n      // Connecting points\n      path.moveToPoint(NSMakePoint(firstLayerPosX,firstLayerPosY))\n      path.lineToPoint(NSMakePoint(secondLayerPosX,secondLayerPosY))\n\n      // Painting the line\n      line = MSShapeGroup.layerWithPath(MSPath.pathWithBezierPath(path))\n      let points = line.layers().firstObject().points()\n\n      points[0].curveMode = points[1].curveMode = 4\n      points[0].hasCurveFrom = points[1].hasCurveTo = true\n\n      if(firstLayerPosY<secondLayerPosY){\n        points[0].curveFrom = {x: 0.5, y: 0}\n        points[0].curveTo = {x: -0.5,y:1}\n\n        points[1].curveFrom = {x: 1,y: 1}\n        points[1].curveTo = {x: 0.5,y: 1}\n      } else {\n        points[0].curveFrom = {x: 0.5, y: 1}\n        points[0].curveTo = {x: -0.5,y:1}\n\n        points[1].curveFrom = {x: 1,y: 1}\n        points[1].curveTo = {x: 0.5,y: 0}\n      }\n    }\n\n    if(direction == \"Down\"){\n      // First Layer Position Start Point Position\n      firstLayerPosX = firstObjectAbsPos.x+firstObjectAbsPos.width/2-diffX\n      firstLayerPosY = firstObjectAbsPos.y+firstObjectAbsPos.height-diffY\n\n      // Second Layer Position End Point Position\n      secondLayerPosX = secondObjectAbsPos.x+secondObjectAbsPos.width/2-diffX\n      secondLayerPosY = secondObjectAbsPos.y-diffY\n\n      // Middle Points\n      middlePosX = (firstLayerPosX + secondLayerPosX)/2\n      middlePosY = (firstLayerPosY + secondLayerPosY)/2\n      \n      // Connecting points\n      path.moveToPoint(NSMakePoint(firstLayerPosX,firstLayerPosY))\n      path.lineToPoint(NSMakePoint(secondLayerPosX,secondLayerPosY))\n\n      // Painting the line\n      line = MSShapeGroup.layerWithPath(MSPath.pathWithBezierPath(path))\n      let points = line.layers().firstObject().points()\n\n      points[0].curveMode = points[1].curveMode = 4\n      points[0].hasCurveFrom = points[1].hasCurveTo = true\n\n      if(firstLayerPosX<secondLayerPosX){\n        points[0].curveFrom = {x: 0, y: 0.5}\n        points[0].curveTo = {x: -0.5,y:1}\n\n        points[1].curveFrom = {x: 1,y: 1}\n        points[1].curveTo = {x: 1,y: 0.5}\n      } else {\n        points[0].curveFrom = {x: 1, y: 0.5}\n        points[0].curveTo = {x: -0.5,y:1}\n\n        points[1].curveFrom = {x: 1,y: 1}\n        points[1].curveTo = {x: 0,y: 0.5}\n      }\n    }\n\n    if(direction == \"Left\"){\n      // First Layer Position Start Point Position\n      firstLayerPosX = firstObjectAbsPos.x-diffX\n      firstLayerPosY = firstObjectAbsPos.y+firstObjectAbsPos.height/2-diffY\n\n      // Second Layer Position End Point Position\n      secondLayerPosX = secondObjectAbsPos.x+secondObjectAbsPos.width-diffX\n      secondLayerPosY = secondObjectAbsPos.y+secondObjectAbsPos.height/2-diffY\n\n      // Middle Points\n      middlePosX = (firstLayerPosX + secondLayerPosX)/2\n      middlePosY = (firstLayerPosY + secondLayerPosY)/2\n\n      // Connecting points\n      path.moveToPoint(NSMakePoint(firstLayerPosX,firstLayerPosY))\n      path.lineToPoint(NSMakePoint(secondLayerPosX,secondLayerPosY))\n\n      // Painting the line\n      line = MSShapeGroup.layerWithPath(MSPath.pathWithBezierPath(path))\n      let points = line.layers().firstObject().points()\n\n      points[0].curveMode = points[1].curveMode = 4\n      points[0].hasCurveFrom = points[1].hasCurveTo = true\n\n      if(firstLayerPosY<secondLayerPosY){\n        points[0].curveFrom = {x: 0.5, y: 0}\n        points[0].curveTo = {x: -0.5,y:1}\n\n        points[1].curveFrom = {x: 1,y: 1}\n        points[1].curveTo = {x: 0.5,y: 1}\n      } else {\n        points[0].curveFrom = {x: 0.5, y: 1}\n        points[0].curveTo = {x: -0.5,y:1}\n\n        points[1].curveFrom = {x: 1,y: 1}\n        points[1].curveTo = {x: 0.5,y: 0}\n      }\n    }\n\n    // Providing Settings for the arrow\n    line.setName(\"Arrows\")\n  }\n\n\n  // Style Start\n  if(style == null){\n    // that means we are creating new arrow\n    if(context.command.valueForKey_onLayer_forPluginIdentifier(\"arrowStyle\", docData, pluginKey)){\n\n      // if we have specified options\n      // TODO: Need to refactor here. Local Style is not used at all\n      let style = getLayerStyles(context.command.valueForKey_onLayer_forPluginIdentifier(\"arrowStyle\", docData, pluginKey))\n      if(style[0] == null){ \n        // Default Arrow Style\n        let border = line.style().addStylePartOfType(1)\n        border.color = MSColor.colorWithRGBADictionary({r: 0.89, g: 0.89, b: 0.89, a: 1})\n        border.thickness = 2\n        line.style().endMarkerType = 2\n      } else {\n        line.sharedStyle = style[0]\n      }\n    } else {\n      // Default Arrow Style\n      let border = line.style().addStylePartOfType(1)\n      border.color = MSColor.colorWithRGBADictionary({r: 0.89, g: 0.89, b: 0.89, a: 1})\n      border.thickness = 2\n      line.style().endMarkerType = 2\n    }\n  } else {\n    // arrow style already provided\n    if(style == \"Default Style\"){\n      // Default Arrow Style\n      let border = line.style().addStylePartOfType(1)\n      border.color = MSColor.colorWithRGBADictionary({r: 0.89, g: 0.89, b: 0.89, a: 1})\n      border.thickness = 2\n      line.style().endMarkerType = 2\n    } else {\n      // User provided own style\n      let ownStyle = getLayerStyles(style)\n      line.sharedStyle = ownStyle[0]\n    }\n  }\n  // Style End\n\n  return line\n}\n\nfunction addToArrowsGroup(line, currentGroup){\n  if(currentGroup){\n    currentGroup.addLayers([line])\n    currentGroup.fixGeometryWithOptions(1)\n  } else {\n    // If we don't have a group\n    let Group = require('sketch/dom').Group\n    let group = new Group({\n      parent: currentParentGroup,\n      name: 'Arrows',\n      locked: true,\n      layers: [line]\n    })\n    // Moving this group to the bottom of the page\n    group.moveToBack()\n    currentGroup = checkForArrowGroup()\n    currentGroup.fixGeometryWithOptions(1)\n  }\n\n  \n  \n}\n\nfunction getConnectionsData(){\n  let dataArray = []\n  let pluginDataConnections = []\n  if(pluginData){\n    pluginDataConnections = context.command.valueForKey_onLayer_forPluginIdentifier(\"arrowConnections\", docData, pluginKey)\n    \n    for (let i = 0; i < pluginDataConnections.length; i ++) {\n      dataArray.push(pluginDataConnections[i])\n    }\n  } \n  return dataArray\n}\n\nfunction findConnectionData(firstObjectID, secondObjectID, data){\n  let arrayNumber = null\n  firstObjectID = String(firstObjectID)\n  secondObjectID = String(secondObjectID)\n\n  if(pluginData){\n    // If we have database, need to check for connections\n\n    for(let y = 0; y < data.length; y++){\n\n      if(firstObjectID == data[y].firstObject || firstObjectID == data[y].secondObject){\n        // if we found that we have this object in connection database already\n        if(secondObjectID == data[y].firstObject || secondObjectID == data[y].secondObject){\n          // if we found that we have this object in connection database already\n          arrayNumber = y\n        } \n      }\n    }\n  }\n  return arrayNumber\n}\n\nfunction setActiveDirectionSetting(arrowDirectionField){\n  let currentDirection = \"Auto\"\n\n  if(Settings.settingForKey(\"arrowDirection\")){\n    // if there is data in settings\n    currentDirection = Settings.settingForKey(\"arrowDirection\")  \n    \n    if(currentDirection == \"Auto\"){\n      arrowDirectionField.addItemWithTitle(\"Auto\")\n      arrowDirectionField.lastItem().setState(1)\n      arrowDirectionField.addItemWithTitle(\"Right\")\n      arrowDirectionField.lastItem().setState(0)\n      arrowDirectionField.addItemWithTitle(\"Down\")\n      arrowDirectionField.lastItem().setState(0)\n      arrowDirectionField.addItemWithTitle(\"Left\")\n      arrowDirectionField.lastItem().setState(0)\n      arrowDirectionField.addItemWithTitle(\"Up\")\n      arrowDirectionField.lastItem().setState(0)\n    } \n    \n    if(currentDirection == \"Right\"){\n      arrowDirectionField.addItemWithTitle(\"Right\")\n      arrowDirectionField.lastItem().setState(1)\n      arrowDirectionField.addItemWithTitle(\"Down\")\n      arrowDirectionField.lastItem().setState(0)\n      arrowDirectionField.addItemWithTitle(\"Left\")\n      arrowDirectionField.lastItem().setState(0)\n      arrowDirectionField.addItemWithTitle(\"Up\")\n      arrowDirectionField.lastItem().setState(0)\n      arrowDirectionField.addItemWithTitle(\"Auto\")\n      arrowDirectionField.lastItem().setState(0)\n    } \n\n    if(currentDirection == \"Down\"){\n      arrowDirectionField.addItemWithTitle(\"Down\")\n      arrowDirectionField.lastItem().setState(1)\n      arrowDirectionField.addItemWithTitle(\"Left\")\n      arrowDirectionField.lastItem().setState(0)\n      arrowDirectionField.addItemWithTitle(\"Up\")\n      arrowDirectionField.lastItem().setState(0)\n      arrowDirectionField.addItemWithTitle(\"Auto\")\n      arrowDirectionField.lastItem().setState(0)\n      arrowDirectionField.addItemWithTitle(\"Right\")\n      arrowDirectionField.lastItem().setState(0)\n    } \n\n    if(currentDirection == \"Left\"){\n      arrowDirectionField.addItemWithTitle(\"Left\")\n      arrowDirectionField.lastItem().setState(1)\n      arrowDirectionField.addItemWithTitle(\"Up\")\n      arrowDirectionField.lastItem().setState(0)\n      arrowDirectionField.addItemWithTitle(\"Auto\")\n      arrowDirectionField.lastItem().setState(0)\n      arrowDirectionField.addItemWithTitle(\"Right\")\n      arrowDirectionField.lastItem().setState(0)\n      arrowDirectionField.addItemWithTitle(\"Down\")\n      arrowDirectionField.lastItem().setState(0)\n    } \n\n    if(currentDirection == \"Up\"){\n      arrowDirectionField.addItemWithTitle(\"Up\")\n      arrowDirectionField.lastItem().setState(1)\n      arrowDirectionField.addItemWithTitle(\"Auto\")\n      arrowDirectionField.lastItem().setState(0)\n      arrowDirectionField.addItemWithTitle(\"Right\")\n      arrowDirectionField.lastItem().setState(0)\n      arrowDirectionField.addItemWithTitle(\"Down\")\n      arrowDirectionField.lastItem().setState(0)\n      arrowDirectionField.addItemWithTitle(\"Left\")\n      arrowDirectionField.lastItem().setState(0)\n    } \n\n  } else {\n    // Show default\n    arrowDirectionField.addItemWithTitle(\"Auto\")\n    arrowDirectionField.addItemWithTitle(\"Right\")\n    arrowDirectionField.addItemWithTitle(\"Down\")\n    arrowDirectionField.addItemWithTitle(\"Left\")\n    arrowDirectionField.addItemWithTitle(\"Up\")\n  }\n}\n\nfunction setActiveStyleSetting(arrowStylingField){\n  let docSettings = context.command.valueForKey_onLayer_forPluginIdentifier(\"arrowStyle\", docData, pluginKey)\n  let styles = getLayerStyles(null)\n\n  if(docSettings){\n    // We have info about the settings in the current document\n    \n    if(docSettings != \"Default Style\") {\n      // if user specified own option\n      arrowStylingField.addItemWithTitle(docSettings)\n      arrowStylingField.addItemWithTitle(\"Default Style\")\n      for(let i = 0; i < styles.length; i++){\n        if(styles[i].name() != docSettings){\n          arrowStylingField.addItemWithTitle(styles[i].name())\n        }\n      }\n\n    } else {\n      // Need to show the default first\n      arrowStylingField.addItemWithTitle(\"Default Style\")\n      for(let i = 0; i < styles.length; i++){\n        arrowStylingField.addItemWithTitle(styles[i].name())\n      }\n    }\n  } else {\n    arrowStylingField.addItemWithTitle(\"Default Style\")\n    for(let i = 0; i < styles.length; i++){\n      arrowStylingField.addItemWithTitle(styles[i].name())\n    }\n  }\n}\n\nfunction setActiveTypeSetting(arrowTypeField){\n  let docTypeSettings = Settings.settingForKey(\"arrowType\")  \n\n\n  if(docTypeSettings){\n    // We have info about the settings in the current document\n    \n    if(docTypeSettings == \"Angled\"){\n      arrowTypeField.addItemWithTitle(\"Angled\")\n      arrowTypeField.lastItem().setState(1)\n      arrowTypeField.addItemWithTitle(\"Curved\")\n      arrowTypeField.lastItem().setState(0)\n      arrowTypeField.addItemWithTitle(\"Straight\")\n      arrowTypeField.lastItem().setState(0)\n    } \n\n    if(docTypeSettings == \"Curved\"){\n      arrowTypeField.addItemWithTitle(\"Curved\")\n      arrowTypeField.lastItem().setState(1)\n      arrowTypeField.addItemWithTitle(\"Straight\")\n      arrowTypeField.lastItem().setState(0)\n      arrowTypeField.addItemWithTitle(\"Angled\")\n      arrowTypeField.lastItem().setState(0)\n    } \n\n    if(docTypeSettings == \"Straight\"){\n      arrowTypeField.addItemWithTitle(\"Straight\")\n      arrowTypeField.lastItem().setState(1)\n      arrowTypeField.addItemWithTitle(\"Angled\")\n      arrowTypeField.lastItem().setState(0)\n      arrowTypeField.addItemWithTitle(\"Curved\")\n      arrowTypeField.lastItem().setState(0)\n    } \n  } else {\n    // Show default\n    arrowTypeField.addItemWithTitle(\"Angled\")\n    arrowTypeField.addItemWithTitle(\"Curved\")\n    arrowTypeField.addItemWithTitle(\"Straight\")\n  }\n\n}\n\nfunction deleteConnectionFromData(arrayNumber){\n  let newConnections = []\n  if(pluginData){\n    // If we have database\n    let connections = context.command.valueForKey_onLayer_forPluginIdentifier(\"arrowConnections\", docData, pluginKey)\n\n    for (let i = 0; i < connections.length; i ++) {\n      // Updating all connections without deleted one\n      if(i != arrayNumber){\n        newConnections.push(connections[i])\n      }\n    }\n  }\n  return newConnections\n}\n\nfunction refactorLines(group){ // Need to finish\n  for(let i = 0; i < group.layers().length; i++){\n    // Here we need to go through each data in our database and delete line if there is no data\n  }\n}\n\nfunction deleteLine(lineID){\n  const lineObject = document.getLayerWithID(lineID)\n  let selectedGroup\n  if(lineObject){\n    selectedGroup = lineObject.parent\n    lineObject.remove()\n    if(selectedGroup.layers.length == 0){\n      selectedGroup.remove()\n    }\n  }\n}\n\nfunction updateSpacing(sourceObjectID, childObjectID, direction){\n  let sourceObject = document.getLayerWithID(sourceObjectID)\n  let childObject = document.getLayerWithID(childObjectID)\n\n  if(Settings.settingForKey(\"arrowSpacing\") && Settings.settingForKey(\"arrowSpacing\") != 0){\n    let currentSpacing = Settings.settingForKey(\"arrowSpacing\")\n    \n    if(direction == \"Right\"){\n      childObject.frame.x = sourceObject.frame.x + sourceObject.frame.width + currentSpacing\n    }\n  \n    if(direction == \"Down\"){\n      childObject.frame.y = sourceObject.frame.y + sourceObject.frame.height + currentSpacing\n    }\n  \n    if(direction == \"Left\"){\n      childObject.frame.x = sourceObject.frame.x - childObject.frame.width - currentSpacing\n    }\n  \n    if(direction == \"Up\"){\n      childObject.frame.y = sourceObject.frame.y - childObject.frame.height - currentSpacing\n    }\n  }\n}\n\nfunction autoAlignLayer(sourceObjectID, childObjectID, direction){\n  let sourceObject = document.getLayerWithID(sourceObjectID)\n  let childObject = document.getLayerWithID(childObjectID)\n  let sourceMidY, childMidY, sourceMidX, childMidX, diff\n\n  if(Settings.settingForKey(\"autoAlign\")){\n    if(Settings.settingForKey(\"autoAlign\") == true){\n      // If user turned on Auto-Align settings\n      \n      if(direction == \"Right\" || direction == \"Left\"){\n        sourceMidY = sourceObject.frame.y + sourceObject.frame.height/2\n        childMidY = childObject.frame.y + childObject.frame.height/2\n        diff = sourceMidY - childMidY\n        if(diff > -6 && diff < 6){childObject.frame.y = childObject.frame.y + diff}\n      }\n    \n      if(direction == \"Down\" || direction == \"Up\"){\n        sourceMidX = sourceObject.frame.x + sourceObject.frame.width/2\n        childMidX = childObject.frame.x + childObject.frame.width/2\n        diff = sourceMidX - childMidX\n        if(diff > -6 && diff < 6){childObject.frame.x = childObject.frame.x + diff}\n      }\n    }\n  }\n}\n\nfunction defineSourceObject(firstObjectID, secondObjectID, direction){\n  let firstObject = document.getLayerWithID(firstObjectID)\n  let secondObject = document.getLayerWithID(secondObjectID)\n  let sourceObjectID\n\n  if(direction == \"Auto\"){\n    sourceObjectID = firstObject.id\n  }\n\n  if(direction == \"Right\"){\n    if(firstObject.frame.x <= secondObject.frame.x){\n      sourceObjectID = firstObject.id\n    } else {\n      sourceObjectID = secondObject.id\n    }\n  }\n\n  if(direction == \"Down\"){\n    if(firstObject.frame.y <= secondObject.frame.y){\n      sourceObjectID = firstObject.id\n    } else {\n      sourceObjectID = secondObject.id\n    }\n  }\n\n  if(direction == \"Left\"){\n    if(firstObject.frame.x <= secondObject.frame.x){\n      sourceObjectID = secondObject.id\n    } else {\n      sourceObjectID = firstObject.id\n    }\n  }\n\n  if(direction == \"Up\"){\n    if(firstObject.frame.y <= secondObject.frame.y){\n      sourceObjectID = secondObject.id\n    } else {\n      sourceObjectID = firstObject.id\n    }\n  }\n\n  return sourceObjectID\n}\n\nfunction getSourceObjectFromSelection(selection, direction){\n  let sourceObjectID = selection.firstObject().objectID()\n  \n  if(direction != \"Auto\"){\n    for(let g = 0; g < selection.count(); g++) {\n      sourceObjectID = defineSourceObject(sourceObjectID, selection[g].objectID(), direction)\n    }\n  } else {\n    sourceObjectID = defineSourceObject(sourceObjectID, selection[0].objectID(), direction)\n  }\n \n  return sourceObjectID\n}\n\nfunction confirmationAlert(alert, message) {\n    // Title\n    alert.setMessageText(\"Would you like to delete all the arrows from \"+message)\n\n    // Creating dialog buttons\n    alert.addButtonWithTitle(\"Delete Arrows\")\n    alert.addButtonWithTitle(\"Cancel\")\n  \n    // Creating the view\n    const viewWidth = 300\n    const viewHeight = 40\n  \n    let view = NSView.alloc().initWithFrame(NSMakeRect(0, 0, viewWidth, viewHeight))\n    alert.addAccessoryView(view)\n  \n    // Label\n    var infoLabel = NSTextField.alloc().initWithFrame(NSMakeRect(-1, viewHeight - 40, 330, 40))\n  \n    infoLabel.setStringValue(\" You can select layers, artboards to delete all the arrows from selected one only\")\n    infoLabel.setSelectable(false)\n    infoLabel.setDrawsBackground(false)\n    infoLabel.setBezeled(false)\n  \n    view.addSubview(infoLabel)\n\n    return alert\n}\n\nfunction alertSetup(alert, viewWidth, viewHeight){\n  // Title\n  alert.setMessageText(\"Arrow Plugin Settings\")\n  \n  // Creating dialog buttons\n  alert.addButtonWithTitle(\"Update Settings\")\n  alert.addButtonWithTitle(\"Cancel\")\n  \n  return alert\n}\n\nfunction alertLabel(message, state, x, y, width, height){\n  let infoLabel = NSTextField.alloc().initWithFrame(NSMakeRect(x, y, width, height))\n\n  infoLabel.setStringValue(message)\n  infoLabel.setSelectable(false)\n  infoLabel.setDrawsBackground(false)\n  infoLabel.setBezeled(false)\n\n  if(state == false){\n    infoLabel.textColor = NSColor.disabledControlTextColor()\n  }\n\n  return infoLabel\n}\n\nfunction alertCheckbox(message, state, x, y, width, height){\n  let checkbox = NSButton.alloc().initWithFrame(NSMakeRect(x, y, width, height))\n\n  checkbox.setButtonType(NSSwitchButton)\n  checkbox.setBezelStyle(0)\n  checkbox.setTitle(message)\n  if(Settings.settingForKey(\"autoAlign\")){\n    let currentState = Settings.settingForKey(\"autoAlign\")  \n    checkbox.setState(currentState)\n  } else {\n    checkbox.setState(state)\n  }\n\n  return checkbox\n}\n\nfunction getLayerStyles(name) {\n  let allStyles = docData.allLayerStyles()\n  let keyword = \"$arrow\"\n  let styles = []\n  if(name == null) {\n    for(let i = 0; i < allStyles.count(); i++){\n      if(allStyles[i].name().includes(keyword)){\n        styles.push(allStyles[i]);\n      }\n    }\n  } else {\n    // Searching only for name\n    for(let i = 0; i < allStyles.count(); i++){\n      if(allStyles[i].name() == name){\n        styles.push(allStyles[i]);\n      }\n    }\n  }\n\treturn styles\n}\n\nfunction start(context, direction){\n  let selection = context.selection\n  let localDirection\n  if(direction == null){localDirection = arrowDirectionSetting} else {localDirection = direction}\n\n  if(selection.count() > 1){\n    // Need to find source object by ID first\n    let sourceObjectID = getSourceObjectFromSelection(selection, direction)\n    let currentConnectionsData = newConnectionsData\n\n    for(let g = 0; g < selection.count(); g++) {\n      if(selection[g].objectID() != sourceObjectID){\n        // Then need to create or update connection arrow with each selection\n        let connectionIndex = findConnectionData(sourceObjectID, selection[g].objectID(), currentConnectionsData)\n        if(connectionIndex != null){\n          // Because this is creating flow, we need to take the direction from user settings\n          updateArrow(sourceObjectID, selection[g].objectID(), null, null, localDirection, currentConnectionsData[connectionIndex].line, connectionIndex)\n          sketch.UI.message(\"Current connection is updated \")\n        } else {\n          // There is no connection with this two objects in our database\n          createArrow(sourceObjectID, selection[g].objectID(), null, null, localDirection)\n          sketch.UI.message(\"New connection is created \")\n        }\n      }\n    }\n    context.command.setValue_forKey_onLayer_forPluginIdentifier(newConnectionsData, \"arrowConnections\", docData, pluginKey)\n  } else {\n    // When user didn't select anything\n    sketch.UI.message(\"Please select more than two layers\")\n  }\n}\n\n// {\n//   \"script\": \"./script.js\",\n//   \"name\" : \"onLayersMoved\",\n//   \"handlers\" : {\n//     \"actions\": {\n//       \"LayersMoved.finish\": \"onLayersMoved\"\n//     }\n//   },\n//   \"identifier\" : \"onLayersMoved\"\n// }\n","module.exports = require(\"sketch\");","module.exports = require(\"sketch/dom\");","module.exports = require(\"sketch/settings\");","module.exports = require(\"sketch/ui\");"],"sourceRoot":""}